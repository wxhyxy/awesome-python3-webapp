{% extends 'base.html' %}

{% blog title %} 编辑日志 {% endblog %}

{% block beforehead %}
<script >
var ID  = "{{ id }}"
	action = '{{ action }}'
function initVM(blog) {
	var vm = new Vue({
		el:'#vm',
		data:blog,
		methods:{
			sumbit: function(event){
				var $form = ('#vm').find('form')
				$form.postJSON(action, this.$data, function(err,r){
					if (err){
						$form.showFormError(err)
					}
					else {
						return location.assign('/api/blogs/'+r.id)
					}
				})
			}
		}
	})
	$('#vm').show()
}
$(function(){
	if (ID){
		getJSON('/apo/blogs/'+ID,function(err,blog){
			if (err){
				return fatal(err)
			}
			$('#loading').hide()
			initVM(blog)
		})
	}
	else{
		$('#loading').hide()
		initVM({
			name:'',
			summary:'',
			content:''
		})
	}
})

</script>
{% endblock %}

{% block content %}

<div class="uk-width-1-1 uk-margin-bottom">
	<div class="uk-panel uk-panel-box">
		<ul class="uk-breadcrumb">
			<li><a href="/manage/comments">评论</a></li>
			<li><a href="/manage/comments">日志</a></li>
			<li><a href="/manage/comments">用户</a></li>
		</ul>
	</div>
</div>

{%endblock%}